<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="Cache-Control" content="no-siteapp" />

    <title>Xmake v2.8.3 Released, Improve Wasm and Support Xmake Source Debugging</title>
    <meta name="description" content="Xmake is a lightweight cross-platform build utility based on Lua.It is very lightweight and has no dependencies because it has a built-in Lua runtime.It uses...">

    
    <meta name="keywords" content="xmake,lua,C/C++,package,performance,API,rust,tboox" />

    <!-- qq oauth -->
    <meta property="qc:admins" content="5211601217706727767255" />

    <!--icon -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" sizes="192x192" href="/static/img/nice-highres.png" />
	<link rel="apple-touch-icon-precomposed" href="/static/img/apple-touch-icon-57x57-precomposed.png" />
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/static/img/apple-touch-icon-72x72-precomposed.png" />
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/static/img/apple-touch-icon-114x114-precomposed.png" />
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/static/img/apple-touch-icon-144x144-precomposed.png" />
	<link rel="apple-touch-icon-precomposed" sizes="180x180" href="/static/img/retinahd_icon.png" />
	<meta name="msapplication-TileImage" content="/static/img/retinahd_icon.png" />

    <link rel="stylesheet" href=" /css/fontawesome/css/font-awesome.min.css ">
    <link rel="stylesheet" href=" /css/main.css ">
    <link rel="canonical" href="https://tboox.org/2023/09/26/xmake-update-v2.8.3/">
    <link rel="alternate" type="application/rss+xml" title="TBOOX Open Source Project" href="https://tboox.org/feed.xml ">
    <link rel="alternate" hreflang="en" href="https://tboox.org/" />
    <link rel="alternate" hreflang="zh-Hans" href="https://tboox.org/cn/" />




    <script type="text/javascript">
    function isPC(){
        var userAgentInfo = navigator.userAgent;
        var Agents = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod");
        var flag = true;
        for (var v = 0; v < Agents.length; v++) {
            if (userAgentInfo.indexOf(Agents[v]) > 0) { flag = false; break; }
        }
        return flag;
    }
    </script>

<!-- wwads -->

    <script type="text/javascript" charset="UTF-8" src="https://cdn.wwads.cn/js/makemoney.js" async></script>


<!-- baidu ads -->



    <!-- baidu ads -->

</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">TBOOX</a>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/cn?lang=0">
                    
                        <i class="fa fa-home"></i>中文
                    </a>
                </li>

                
                    
                     
                    
                
                    
                     
                     
                    <li>

                        
                            
                            <a href="/project/">
                            
                        
                            <i class="fa fa-bookmark"></i>Projects
                        </a>
                    </li>
                    
                    
                    
                
                    
                     
                    
                
                    
                     
                     
                    <li>

                        
                            
                            <a href="/archive/">
                            
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                    
                    
                
                    
                     
                    
                
                    
                     
                     
                    <li>

                        
                            
                            <a href="/category/">
                            
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                    
                    
                
                    
                     
                    
                
                    
                     
                     
                    <li>

                        
                            
                            <a href="/tag/">
                            
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                    
                    
                
                    
                     
                     
                    <li>

                        
                            
                            <a href="/404.html/">
                            
                        
                            <i class="fa fa-heart"></i>捐助
                        </a>
                    </li>
                    
                    
                    
                
                    
                     
                    
                
                    
                     
                     
                    <li>

                        
                            
                            <a href="/docs/">
                            
                        
                            <i class="fa fa-book"></i>Documents
                        </a>
                    </li>
                    
                    
                    
                
                    
                     
                    
                
                    
                     
                     
                    <li>

                        
                            
                            <a href="https://xmake.io/#/about/contact" target="_blank" >
                            
                        
                            <i class="fa fa-forumbee"></i>Community
                        </a>
                    </li>
                    
                    
                    
                
                    
                     
                    
                
                    
                     
                     
                    <li>

                        
                            
                            <a href="/donation/">
                            
                        
                            <i class="fa fa-heart"></i>Donate
                        </a>
                    </li>
                    
                    
                    
                
                    
                     
                    
                
                    
                     
                     
                    <li>

                        
                            
                            <a href="/about/">
                            
                        
                            <i class="fa fa-user"></i>About
                        </a>
                    </li>
                    
                    
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                     
                     
                    
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>



        <div class="page clearfix" post>
    <div class="left">
        <h1>Xmake v2.8.3 Released, Improve Wasm and Support Xmake Source Debugging</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i>2023-09-26
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#xmake" title="Category: xmake" rel="category">xmake</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

            <div class="label-card">
            
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <!--a href="/tag/#xmake" title="Tag: xmake" rel="tag">xmake</a-->
        <a href="/tag/#xmake" title="Tag: xmake" rel="tag">xmake</a>&nbsp;
    
        <!--a href="/tag/#lua" title="Tag: lua" rel="tag">lua</a-->
        <a href="/tag/#lua" title="Tag: lua" rel="tag">lua</a>&nbsp;
    
        <!--a href="/tag/#C%2FC%2B%2B" title="Tag: C/C++" rel="tag">C/C++</a-->
        <a href="/tag/#C/C++" title="Tag: C/C++" rel="tag">C/C++</a>&nbsp;
    
        <!--a href="/tag/#package" title="Tag: package" rel="tag">package</a-->
        <a href="/tag/#package" title="Tag: package" rel="tag">package</a>&nbsp;
    
        <!--a href="/tag/#performance" title="Tag: performance" rel="tag">performance</a-->
        <a href="/tag/#performance" title="Tag: performance" rel="tag">performance</a>&nbsp;
    
        <!--a href="/tag/#API" title="Tag: API" rel="tag">API</a-->
        <a href="/tag/#API" title="Tag: API" rel="tag">API</a>&nbsp;
    
        <!--a href="/tag/#rust" title="Tag: rust" rel="tag">rust</a-->
        <a href="/tag/#rust" title="Tag: rust" rel="tag">rust</a>
    
  

</span>

            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
        <p><a href="https://github.com/xmake-io/xmake">Xmake</a> is a lightweight cross-platform build utility based on Lua.</p>

<p>It is very lightweight and has no dependencies because it has a built-in Lua runtime.</p>

<p>It uses xmake.lua to maintain project builds and its configuration syntax is very simple and readable.</p>

<p>We can use it to build project directly like Make/Ninja, or generate project files like CMake/Meson, and it also has a built-in package management system to help users solve the integrated use of C/C++ dependent libraries.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Xmake = Build backend + Project Generator + Package Manager + [Remote|Distributed] Build + Cache
</code></pre>
</div>

<p>Although not very precise, we can still understand Xmake in the following way:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Xmake ≈ Make/Ninja + CMake/Meson + Vcpkg/Conan + distcc + ccache/sccache
</code></pre>
</div>

<ul>
  <li><a href="https://github.com/xmake-io/xmake">Github</a></li>
  <li><a href="https://xmake.io/">Document</a></li>
</ul>

<p><img src="https://github.com/xmake-io/xmake-docs/raw/master/assets/img/index/package.gif" width="650px" /></p>

<h2 id="introduction-of-new-features">Introduction of new features</h2>

<p>In the new version, we have added breakpoint debugging support for Xmake’s own source code, which can help contributors to get familiar with xmake’s source code more quickly, and also help users to debug and analyse their own project’s configure scripts.</p>

<p>In addition, the number of packages in our <a href="https://github.com/xmake-io/xmake-repo">xmake-repo</a> repository is about to exceed 1100, with more than 100 packages added in just one month, thanks to @star-hengxing’s contribution.</p>

<p>At the same time, we focused on improving build support for Wasm and Qt6 for wasm.</p>

<h3 id="breakpoint-debugging-xmake">Breakpoint Debugging Xmake</h3>

<p>In version 2.8.3, we added Lua breakpoint debugging support, with <a href="https://github.com/EmmyLua/VSCode-EmmyLua">VSCode-EmmyLua</a> plugin, we can easily debug Xmake source code in VSCode breakpoints.</p>

<p>First of all, we need to install VSCode-EmmyLua plugin in VSCode’s plugin market, and then run the following command to update the xmake-repo repository to keep it up-to-date.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xrepo update-repo
</code></pre>
</div>

<p>!&gt; Xmake also needs to be kept up to date.</p>

<p>Then, execute the following command in your own project directory:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xrepo env -b emmylua_debugger -- xmake build
</code></pre>
</div>

<p>The <code class="highlighter-rouge">xrepo env -b emmylua_debugger</code> is used to bind the EmmyLua debugger plugin environment, and the arguments after <code class="highlighter-rouge">--</code> are the actual xmake commands we need to debug.</p>

<p>Usually we just debug the <code class="highlighter-rouge">xmake build</code> build, but if you want to debug other commands, you can tweak it yourself, for example, if you want to debug the <code class="highlighter-rouge">xmake install -o /tmp</code> install command, you can change it to:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xrepo env -b emmylua_debugger -- xmake install -o /tmp
</code></pre>
</div>

<p>After executing the above command, it will not exit immediately, it will remain in a waiting debugging state, possibly without any output.</p>

<p>At this point, instead of exiting it, let’s go ahead and open VSCode and open Xmake’s Lua script source directory in VSCode.</p>

<p>That is, this directory: <a href="https://github.com/xmake-io/xmake/tree/master/xmake">Xmake Lua Scripts</a>, which we can download locally or directly open the lua script directory in the Xmake installation directory.</p>

<p>Then switch to VSCode’s debugging tab and click <code class="highlighter-rouge">RunDebug</code> -&gt; <code class="highlighter-rouge">Emmylua New Debug</code> to connect to our <code class="highlighter-rouge">xmake build</code> command debugger and start debugging.</p>

<p>As you can see below, the default start breakpoint will automatically break inside <code class="highlighter-rouge">debugger:_start_emmylua_debugger</code>, and we can click on the single-step to jump out of the current function, which will take us to the main entry.</p>

<p><img src="https://xmake.io/assets/img/manual/xmake-debug.png" alt="" /></p>

<p>Then set your own breakpoint and click Continue to Run to break to the code location you want to debug.</p>

<p>We can also set breakpoints in our project’s configuration scripts, which also allows us to quickly debug our own configuration scripts, not just Xmake’s own source code.</p>

<p><img src="https://xmake.io/assets/img/manual/xmake-debug2.png" alt="" /></p>

<h3 id="remote-debugging-xmake">Remote debugging xmake</h3>

<p>Version 2.8.3 now supports remote debugging, but this feature is mainly for the author, because the author’s development computer is a mac, but sometimes he still needs to be able to debug xmake source scripts on windows.</p>

<p>But debugging in a virtual machine is too laggy, not good experience, and the author’s own computer does not have enough disk space, so I usually connect to a separate windows host to debug xmake source code remotely.</p>

<p>Let’s start the remote compilation service on the windows machine:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake service
</code></pre>
</div>

<p>Then locally, open the project directory where you want to build, make a remote connection, and then run <code class="highlighter-rouge">xmake service --sync --xmakesrc=</code> to synchronise the local source:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake service --connect
<span class="gp">$ </span>xmake service --sync --xmakesrc<span class="o">=</span>~/projects/personal/xmake/xmake/
<span class="gp">$ </span>xmake build
<span class="gp">$ </span>xmake run
</code></pre>
</div>

<p>This way, we can modify the xmake script source locally, sync it to a remote windows machine, and then execute the xmake build command remotely to get the corresponding debug output and analyse the build behaviour.</p>

<p>We can also pull the remote files back to the local machine for analysis with the <code class="highlighter-rouge">xmake service --pull=</code> command.</p>

<p>Note: See <a href="http://xmake.io/#/features/remote_build">Remote Build Documentation</a> for a detailed description of remote build features.</p>

<p><img src="https://xmake.io/assets/img/manual/xmake-remote.png" alt="" /></p>

<h3 id="support-for-cppfront-programmes">Support for Cppfront programmes</h3>

<p>We have also added a new build rule to support the compilation of <a href="https://github.com/hsutter/cppfront">cppfront</a> programs:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>add_rules<span class="o">(</span><span class="s2">"mode.debug"</span>, <span class="s2">"mode.release"</span><span class="o">)</span>

add_requires<span class="o">(</span><span class="s2">"cppfront"</span><span class="o">)</span>

target<span class="o">(</span><span class="s2">"test"</span><span class="o">)</span>
    add_rules<span class="o">(</span><span class="s2">"cppfront"</span><span class="o">)</span>
    set_kind<span class="o">(</span><span class="s2">"binary"</span><span class="o">)</span>
    add_files<span class="o">(</span><span class="s2">"src/*.cpp2"</span><span class="o">)</span>
    add_packages<span class="o">(</span><span class="s2">"cppfront"</span><span class="o">)</span>
</code></pre>
</div>

<h3 id="added-utilshlsl2spv-build-rule">Added utils.hlsl2spv build rule</h3>

<p>We’ve already provided the <code class="highlighter-rouge">utils.glsl2spv</code> rule to support the compilation and use of glsl, but now we’ve added the <code class="highlighter-rouge">utils.hlsl2spv</code> rule to support the compilation of hlsl.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>add_rules<span class="o">(</span><span class="s2">"mode.debug"</span>, <span class="s2">"mode.release"</span><span class="o">)</span>

add_requires<span class="o">(</span><span class="s2">"glslang"</span>, <span class="o">{</span>configs <span class="o">=</span> <span class="o">{</span>binaryonly <span class="o">=</span> <span class="nb">true</span><span class="o">}})</span>

target<span class="o">(</span><span class="s2">"test"</span><span class="o">)</span>
    set_kind<span class="o">(</span><span class="s2">"binary"</span><span class="o">)</span>
    add_rules<span class="o">(</span><span class="s2">"utils.hlsl2spv"</span>, <span class="o">{</span>bin2c <span class="o">=</span> <span class="nb">true</span><span class="o">})</span>
    add_files<span class="o">(</span><span class="s2">"src/*.c"</span><span class="o">)</span>
    add_files<span class="o">(</span><span class="s2">"src/*.hlsl"</span>, <span class="s2">"src/*.hlsl"</span><span class="o">)</span>
    add_packages<span class="o">(</span><span class="s2">"directxshadercompiler"</span><span class="o">)</span>
</code></pre>
</div>

<p>For a detailed description of this rule, see the documentation: <a href="https://xmake.io/#/manual/custom_rule?id=utilsglsl2spv">utils.glsl2spv</a>, both are used in a similar way and principle.</p>

<h3 id="add-libluapackage-module">Add lib.lua.package module.</h3>

<p>Xmake restricts access to native lua modules and interfaces by default, and this module is mainly used to open up some of the APIs provided by lua to be used on demand.</p>

<p>Currently, it only provides the <code class="highlighter-rouge">package.loadlib</code> interface for loading lua modules from the native so/dylib/dll dynamic library.</p>

<p>This is typically used in high-performance scenarios.</p>

<pre><code class="language-Lua">import("lib.lub.package")

local script = package.loadlib("/xxx/libfoo.so", "luaopen_mymodule")
local mymodule = script()
mymodule.hello()
</code></pre>

<h3 id="improved-address-sanitizer-support">Improved Address sanitizer support</h3>

<p>Address Sanitizer (ASan) is a fast memory error detection tool that is built-in by the compiler, and normally we need to configure <code class="highlighter-rouge">-fsanitize-address</code> in both compilation and linking flags to enable it properly.</p>

<p>In previous versions, we supported this by configuring <code class="highlighter-rouge">add_rules("mode.asan")</code> and then <code class="highlighter-rouge">xmake f -m asan</code> to switch build modes.</p>

<p>But there are a few problems with this:</p>

<ol>
  <li>it doesn’t work on dependent packages</li>
  <li>you need to switch build modes</li>
  <li>asan and ubsan cannot be detected at the same time.</li>
</ol>

<p>Therefore, in the new version, we have switched to using policy to support them better.</p>

<p>We can quickly enable it globally by turning on the <code class="highlighter-rouge">build.sanitizer.address</code> policy, which will enable compiled applications to support ASan detection directly.</p>

<p>For example, we can enable it from the command line:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake f --policies<span class="o">=</span>build.sanitizer.address
</code></pre>
</div>

<p>It can also be enabled globally via the interface configuration:</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">set_policy</span><span class="p">(</span><span class="s2">"build.sanitizer.address"</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
</code></pre>
</div>

<p>Of course, we can also enable it for a specific target individually, and if we configure it globally, we can enable it for all dependent packages at the same time.</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">set_policy</span><span class="p">(</span><span class="s2">"build.sanitizer.address"</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>

<span class="n">add_requires</span><span class="p">(</span><span class="s2">"zlib"</span><span class="p">)</span>
<span class="n">add_requires</span><span class="p">(</span><span class="s2">"libpng"</span><span class="p">)</span>
</code></pre>
</div>

<p>It is equivalent to setting the asan configuration for each package in turn.</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">add_requires</span><span class="p">(</span><span class="s2">"zlib"</span><span class="p">,</span> <span class="p">{</span><span class="n">configs</span> <span class="o">=</span> <span class="p">{</span><span class="n">asan</span> <span class="o">=</span> <span class="kc">true</span><span class="p">}})</span>
<span class="n">add_requires</span><span class="p">(</span><span class="s2">"libpng"</span><span class="p">,</span> <span class="p">{</span><span class="n">configs</span> <span class="o">=</span> <span class="p">{</span><span class="n">asan</span> <span class="o">=</span> <span class="kc">true</span><span class="p">}})</span>
</code></pre>
</div>

<p>Alternatively, we can have multiple sanitizer detections in effect at the same time, for example:</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">set_policy</span><span class="p">(</span><span class="s2">"build.sanitizer.address"</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
<span class="n">set_policy</span><span class="p">(</span><span class="s2">"build.sanitizer.undefined"</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
</code></pre>
</div>

<p>or</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake f --policies<span class="o">=</span>build.sanitizer.address,build.sanitizer.undefined
</code></pre>
</div>

<p>In addition to Asan, we provide other similar policies for detecting threads, memory leaks, and so on.</p>

<ul>
  <li>build.sanitizer.thread</li>
  <li>build.sanitizer.memory</li>
  <li>build.sanitizer.leak</li>
  <li>build.sanitizer.undefined</li>
</ul>

<h3 id="autobuild-before-running">Autobuild before running</h3>

<p>We have added a new <code class="highlighter-rouge">run.atuobuild</code> policy to adjust the behaviour of <code class="highlighter-rouge">xmake run</code>. By default, running <code class="highlighter-rouge">xmake run</code> does not automatically build the target application, but prompts the user to build it manually if the application has not yet been compiled.</p>

<p>By turning on this policy, we can automatically build the target program before running it.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake f --policies<span class="o">=</span>run.autobuild
<span class="gp">$ </span>xmake run
</code></pre>
</div>

<p>If you want this policy to take effect globally, you can turn it on globally.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake g --policies<span class="o">=</span>run.autobuild
</code></pre>
</div>

<h3 id="shallow-build-of-a-specified-target">Shallow build of a specified target</h3>

<p>When we specify to rebuild a target, if it has a lot of dependent targets, then they are usually all rebuilt.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake --rebuild foo
rebuild foo
rebuild foo.dep1
rebuild foo.dep2
...
</code></pre>
</div>

<p>This can be very slow for large projects with a lot of target dependencies, and can mean that half of the project has to be rebuilt.</p>

<p>In the new version, we’ve added a <code class="highlighter-rouge">--shallow</code> parameter to tell Xmake to only rebuild the specified target, and not to rebuild all of its dependencies.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake --rebuild --shallow foo
only rebuild foo
</code></pre>
</div>

<h3 id="improved-warning-settings">Improved warning settings</h3>

<p>The <code class="highlighter-rouge">set_warnings</code> interface has new <code class="highlighter-rouge">extra</code> and <code class="highlighter-rouge">pedantic</code> settings and supports combining multiple warning values.</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">set_warnings</span><span class="p">(</span><span class="s2">"all"</span><span class="p">,</span> <span class="s2">"extra"</span><span class="p">)</span>
<span class="n">set_warnings</span><span class="p">(</span><span class="s2">"pedantic"</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="improving-wasm-builds">Improving Wasm Builds</h3>

<p>Now we can pull the emscripten toolchain ourselves and use it to build wasm programs automatically with the following configuration.</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="k">if</span> <span class="n">is_plat</span><span class="p">(</span><span class="s2">"wasm"</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">add_requires</span><span class="p">(</span><span class="s2">"emscripten"</span><span class="p">)</span>
    <span class="n">set_toolchains</span><span class="p">(</span><span class="s2">"emcc@emscripten"</span><span class="p">)</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Simply just run</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake f -p wasm
<span class="gp">$ </span>xmake
</code></pre>
</div>

<p>to build the wasm application, so you don’t have to manually install emscripten yourself, which is much more convenient.</p>

<p>We also have good support for Qt6 for wasm.</p>

<h2 id="changelog">Changelog</h2>

<h3 id="new-features">New features</h3>

<ul>
  <li><a href="https://github.com/xmake-io/xmake/issues/4122">#4122</a>: Support Lua Debugger (EmmyLua)</li>
  <li><a href="https://github.com/xmake-io/xmake/pull/4132">#4132</a>: Support cppfront</li>
  <li><a href="https://github.com/xmake-io/xmake/issues/4147">#4147</a>: Add hlsl2spv rule</li>
  <li><a href="https://github.com/xmake-io/xmake/issues/4226">#4226</a>: Support sanitizers for package and policy</li>
  <li>Add lib.lua.package module</li>
  <li>Add <code class="highlighter-rouge">run.autobuild</code> policy</li>
  <li>Add global policies <code class="highlighter-rouge">xmake g --policies=</code></li>
</ul>

<h3 id="changes">Changes</h3>

<ul>
  <li><a href="https://github.com/xmake-io/xmake/issues/4119">#4119</a>: Improve to support emcc toolchain and emscripten package</li>
  <li><a href="https://github.com/xmake-io/xmake/issues/4154">#4154</a>: Add <code class="highlighter-rouge">xmake -r --shallow target</code> to rebuild target without deps</li>
  <li>Add global ccache storage directory</li>
  <li><a href="https://github.com/xmake-io/xmake/issues/4137">#4137</a>: Support Qt6 for Wasm</li>
  <li><a href="https://github.com/xmake-io/xmake/issues/4173">#4173</a>: Add recheck argument to on_config</li>
  <li><a href="https://github.com/xmake-io/xmake/pull/4200">#4200</a>: Improve remote build to support debugging xmake source code.</li>
  <li><a href="https://github.com/xmake-io/xmake/issues/4209">#4209</a>: Add extra and pedantic warnings</li>
</ul>

<h3 id="bugs-fixed">Bugs fixed</h3>

<ul>
  <li><a href="https://github.com/xmake-io/xmake/issues/4110">#4110</a>: Fix extrafiles</li>
  <li><a href="https://github.com/xmake-io/xmake/issues/4115">#4115</a>: Fix compile_commands generator for clangd</li>
  <li><a href="https://github.com/xmake-io/xmake/pull/4199">#4199</a>: Fix compile_commands generator for c++ modules</li>
  <li>Fix os.mv fail on window</li>
  <li><a href="https://github.com/xmake-io/xmake/issues/4214">#4214</a>: Fix rust workspace build error</li>
</ul>

        </article>
        <hr>

        <!-- wwads -->
        
        <div class="wwads-cn wwads-horizontal" data-id="243" style="max-width:100%"></div>
        

        <!-- baidu ads -->
        

        
        
            
        
            
            
                
            
        
            
        
            
            
                
                    
                    <h2 id="chinese">中文</h2>
                    <ul>
                    
                    <li class="relatedPost">
                        <a href="/cn/2023/09/26/xmake-update-v2.8.3/">Xmake v2.8.3 发布，改进 Wasm 并支持 Xmake 源码调试
                        
                        </a>
                    </li>
                    
                    
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
        
            </ul>
        

        
        
            
            
            
                
                    
                        
                        <h2 id="similar_posts">Similar Posts</h2>
                        <ul>
                        
                        <li class="relatedPost">
                            <a href="/2023/11/05/xmake-update-v2.8.5/">Xmake v2.8.5 released, Support for link sorting and unit testing
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
            
        
            
        
            
        
            
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/2023/08/22/xmake-update-v2.8.2/">Xmake v2.8.2 Released, Official package repository count over 1k
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
            
        
            
        
            
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/2023/07/11/xmake-update-v2.8.1/">Xmake v2.8.1 Released, Lots of Detailed Feature Improvements
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
            
        
            
        
            
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/2023/04/04/xmake-update-v2.7.8/">Xmake v2.7.8 released, Improve package virtual environment and build speed
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
            
        
            
        
            
            
            
            
        
        
            </ul>
        

        <div class="post-recent">
    <div class="pre">

        

        

        
        
        

        

        

        
        
        <p><strong>Prev Post</strong> <a href="/2023/08/22/xmake-update-v2.8.2/">Xmake v2.8.2 Released, Official package repository count over 1k</a></p>
        
    </div>

    <div class="nex">

        

        

        
        
        

        

        

        
        
        <p><strong>Next Post</strong> <a href="/2023/11/05/xmake-update-v2.8.5/">Xmake v2.8.5 released, Support for link sorting and unit testing</a></p>
        
    </div>
</div>


        <h2 id="comments">Comments</h2>
        









    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    Content
                </div>
                <ul id="content-side" class="content-ul">
                    <li><a href="#chinese">中文</a></li>
                    <li><a href="#similar_posts">Similar Posts</a></li>
                    <li><a href="#comments">Comments</a></li>
                </ul>
            </div>

            <!-- wwads -->
            
            <div class="side">
            <div class="wwads-cn wwads-vertical" data-id="243" style="max-width:255px;height:250px"></div>
            </div>
            

            <!-- baidu ads -->
            

            <br>
            <div class="side">
                <div>
                    <i class="fa fa-external-link"></i>
                    Links
                </div>
                <ul class="content-ul">
                  <li><a href="http://github.com/waruqi/tbox">tbox</a></li>
                  <li><a href="http://www.xmake.io">xmake</a></li>
                  <li><a href="https://github.com/waruqi">github</a></li>
                </ul>
            </div>

            <!-- google ads -->
            

            <!-- baidu ads -->
            

            <!-- chitika ads -->
            
        </div>
    </div>

    <!-- baidu ads -->
    
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<script src="/js/pageContent.js " charset="utf-8"></script>



    <footer class="site-footer">
    <div class="wrapper">
        <p class="description">
             Copyright (c) 2016-latest tboox.org 
        </p>
        <p class="contact">
            
            <a href="https://github.com/waruqi" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a> 
             
            
            <a href="mailto:waruqi@gmail.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a> 
            
            
            <a href="https://twitter.com/waruqi" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a> 
            
            <a href="/feed.xml" title="feed"><i class="fa fa-feed" aria-hidden="true"></i></a> 
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://github.com/Gaohaoyang">HyG</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
        </p>
    </div>
</footer>

    <div class="back-to-top">
    <a href="#top" class="scroll">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/scroll.min.js " charset="utf-8"></script>
  </body>

</html>
