<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="Cache-Control" content="no-siteapp" />

    <title>Xmake v2.8.6 发布，新的打包插件：XPack</title>
    <meta name="description" content="Xmake 是一个基于 Lua 的轻量级跨平台构建工具。它非常的轻量，没有任何依赖，因为它内置了 Lua 运行时。它使用 xmake.lua 维护项目构建，相比 makefile/CMakeLists.txt，配置语法更加简洁直观，对新手非常友好，短时间内就能快速入门，能够让用户把更多的精力集中在实际的项目开发上...">

    
    <meta name="keywords" content="xmake,lua,C/C++,tboox" />

    <!-- qq oauth -->
    <meta property="qc:admins" content="5211601217706727767255" />

    <!--icon -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" sizes="192x192" href="/static/img/nice-highres.png" />
	<link rel="apple-touch-icon-precomposed" href="/static/img/apple-touch-icon-57x57-precomposed.png" />
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/static/img/apple-touch-icon-72x72-precomposed.png" />
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/static/img/apple-touch-icon-114x114-precomposed.png" />
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/static/img/apple-touch-icon-144x144-precomposed.png" />
	<link rel="apple-touch-icon-precomposed" sizes="180x180" href="/static/img/retinahd_icon.png" />
	<meta name="msapplication-TileImage" content="/static/img/retinahd_icon.png" />

    <link rel="stylesheet" href=" /css/fontawesome/css/font-awesome.min.css ">
    <link rel="stylesheet" href=" /css/main.css ">
    <link rel="canonical" href="https://tboox.org/cn/2023/12/15/xmake-update-v2.8.6/">
    <link rel="alternate" type="application/rss+xml" title="TBOOX Open Source Project" href="https://tboox.org/feed.xml ">
    <link rel="alternate" hreflang="en" href="https://tboox.org/" />
    <link rel="alternate" hreflang="zh-Hans" href="https://tboox.org/cn/" />

    <!-- css -->
    <link href="/css/reward.css" rel="stylesheet" type="text/css">




    <script type="text/javascript">
    function isPC(){
        var userAgentInfo = navigator.userAgent;
        var Agents = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod");
        var flag = true;
        for (var v = 0; v < Agents.length; v++) {
            if (userAgentInfo.indexOf(Agents[v]) > 0) { flag = false; break; }
        }
        return flag;
    }
    </script>

<!-- wwads -->

    <script type="text/javascript" charset="UTF-8" src="https://cdn.wwads.cn/js/makemoney.js" async></script>


<!-- baidu ads -->



    <!-- baidu ads -->

</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/cn" class="brand">TBOOX</a>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/?lang=0">
                    
                        <i class="fa fa-home"></i>English
                    </a>
                </li>

                
                    
                    
                    <li>
                        
                            
                            <a href="/cn/project/">
                            
                        
                            <i class="fa fa-bookmark"></i>项目
                        </a>
                    </li>
                    
                    
                
                    
                    
                    
                
                    
                    
                    <li>
                        
                            
                            <a href="/cn/archive/">
                            
                        
                            <i class="fa fa-archive"></i>归档
                        </a>
                    </li>
                    
                    
                
                    
                    
                    
                
                    
                    
                    <li>
                        
                            
                            <a href="/cn/category/">
                            
                        
                            <i class="fa fa-th-list"></i>分类
                        </a>
                    </li>
                    
                    
                
                    
                    
                    
                
                    
                    
                    <li>
                        
                            
                            <a href="/cn/tag/">
                            
                        
                            <i class="fa fa-tags"></i>标记
                        </a>
                    </li>
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    <li>
                        
                            
                            <a href="/cn/docs/">
                            
                        
                            <i class="fa fa-book"></i>文档
                        </a>
                    </li>
                    
                    
                
                    
                    
                    
                
                    
                    
                    <li>
                        
                            
                            <a href="https://xmake.io/#/zh-cn/about/contact" target="_blank" >
                            
                        
                            <i class="fa fa-forumbee"></i>社区
                        </a>
                    </li>
                    
                    
                
                    
                    
                    
                
                    
                    
                    <li>
                        
                            
                            <a href="/cn/donation/">
                            
                        
                            <i class="fa fa-heart"></i>捐助
                        </a>
                    </li>
                    
                    
                
                    
                    
                    
                
                    
                    
                    <li>
                        
                            
                            <a href="/cn/about/">
                            
                        
                            <i class="fa fa-user"></i>关于
                        </a>
                    </li>
                    
                    
                
                    
                    
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                    
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>



        <div class="page clearfix" post>
    <div class="left">
        <h1>Xmake v2.8.6 发布，新的打包插件：XPack</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i>2023-12-15
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#xmake" title="Category: xmake" rel="category">xmake</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

            <div class="label-card">
            
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <!--a href="/tag/#xmake" title="Tag: xmake" rel="tag">xmake</a-->
        <a href="/cn/tag/#xmake" title="Tag: xmake" rel="tag">xmake</a>&nbsp;
    
        <!--a href="/tag/#lua" title="Tag: lua" rel="tag">lua</a-->
        <a href="/cn/tag/#lua" title="Tag: lua" rel="tag">lua</a>&nbsp;
    
        <!--a href="/tag/#C%2FC%2B%2B" title="Tag: C/C++" rel="tag">C/C++</a-->
        <a href="/cn/tag/#C/C++" title="Tag: C/C++" rel="tag">C/C++</a>
    
  

</span>

            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
        <p><a href="https://github.com/xmake-io/xmake">Xmake</a> 是一个基于 Lua 的轻量级跨平台构建工具。</p>

<p>它非常的轻量，没有任何依赖，因为它内置了 Lua 运行时。</p>

<p>它使用 xmake.lua 维护项目构建，相比 makefile/CMakeLists.txt，配置语法更加简洁直观，对新手非常友好，短时间内就能快速入门，能够让用户把更多的精力集中在实际的项目开发上。</p>

<p>我们能够使用它像 Make/Ninja 那样可以直接编译项目，也可以像 CMake/Meson 那样生成工程文件，另外它还有内置的包管理系统来帮助用户解决 C/C++ 依赖库的集成使用问题。</p>

<p>目前，Xmake 主要用于 C/C++ 项目的构建，但是同时也支持其他 native 语言的构建，可以实现跟 C/C++ 进行混合编译，同时编译速度也是非常的快，可以跟 Ninja 持平。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Xmake = Build backend + Project Generator + Package Manager + [Remote|Distributed] Build + Cache
</code></pre>
</div>

<p>尽管不是很准确，但我们还是可以把 Xmake 按下面的方式来理解：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Xmake ≈ Make/Ninja + CMake/Meson + Vcpkg/Conan + distcc + ccache/sccache
</code></pre>
</div>

<ul>
  <li><a href="https://github.com/xmake-io/xmake">项目源码</a></li>
  <li><a href="https://xmake.io/#/zh-cn/">官方文档</a></li>
  <li><a href="https://xmake.io/#/zh-cn/about/course">入门课程</a></li>
</ul>

<h2 id="新特性介绍">新特性介绍</h2>

<p>在介绍新特性之前，还有个好消息告诉大家，上个版本 Xmake 被收入到了 debian 仓库，而最近 Xmake 又进入了 Fedora 官方仓库，大家可以在 Fedora 39 上，直接通过下面的命令安装 Xmake。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sudo dnf install xmake
</code></pre>
</div>

<p>非常感谢 @topazus @mochaaP 对 Xmake 的贡献，相关信息见：<a href="https://github.com/xmake-io/xmake/issues/941">#941</a>。</p>

<p>接下来，我们来介绍下，新版本带来的重量级特性：XPack。</p>

<p>它类似于 CMake 的 CPack 命令，可以将用户工程快速打包生成各种格式的安装包。</p>

<p>目前 Xmake 的 XPack 已经支持以下格式的打包：</p>

<ul>
  <li>nsis: Windows 下的可执行安装包</li>
  <li>runself: shell 自编译安装包</li>
  <li>targz: 二进制文件 tar.gz 包（绿色版）</li>
  <li>zip: 二进制文件 zip 包（绿色版）</li>
  <li>srctargz：源文件 tar.gz 包</li>
  <li>srczip: 源文件 zip 包</li>
  <li>srpm: rpm 源码安装包</li>
  <li>rpm: rpm 二进制安装包</li>
</ul>

<p>除了上述已经支持的打包格式，还有 deb 等包格式也在陆续支持中，并且用户也可以配置生成自定义的包格式文件。</p>

<h3 id="xpack-打包">XPack 打包</h3>

<p>下面是一个完整例子，我们可以先简单看下：</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">set_version</span><span class="p">(</span><span class="s2">"1.0.0"</span><span class="p">)</span>
<span class="n">add_rules</span><span class="p">(</span><span class="s2">"mode.debug"</span><span class="p">,</span> <span class="s2">"mode.release"</span><span class="p">)</span>

<span class="n">includes</span><span class="p">(</span><span class="s2">"@builtin/xpack"</span><span class="p">)</span>

<span class="n">target</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
    <span class="n">set_kind</span><span class="p">(</span><span class="s2">"binary"</span><span class="p">)</span>
    <span class="n">add_files</span><span class="p">(</span><span class="s2">"src/*.cpp"</span><span class="p">)</span>

<span class="n">xpack</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
    <span class="n">set_formats</span><span class="p">(</span><span class="s2">"nsis"</span><span class="p">,</span> <span class="s2">"zip"</span><span class="p">,</span> <span class="s2">"targz"</span><span class="p">,</span> <span class="s2">"runself"</span><span class="p">)</span>
    <span class="n">set_title</span><span class="p">(</span><span class="s2">"hello"</span><span class="p">)</span>
    <span class="n">set_author</span><span class="p">(</span><span class="s2">"ruki"</span><span class="p">)</span>
    <span class="n">set_description</span><span class="p">(</span><span class="s2">"A test installer."</span><span class="p">)</span>
    <span class="n">set_homepage</span><span class="p">(</span><span class="s2">"https://xmake.io"</span><span class="p">)</span>
    <span class="n">set_licensefile</span><span class="p">(</span><span class="s2">"LICENSE.md"</span><span class="p">)</span>
    <span class="n">add_targets</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
    <span class="n">add_installfiles</span><span class="p">(</span><span class="s2">"src/(assets/*.png)"</span><span class="p">,</span> <span class="p">{</span><span class="n">prefixdir</span> <span class="o">=</span> <span class="s2">"images"</span><span class="p">})</span>
    <span class="n">add_sourcefiles</span><span class="p">(</span><span class="s2">"(src/**)"</span><span class="p">)</span>
    <span class="n">set_iconfile</span><span class="p">(</span><span class="s2">"src/assets/xmake.ico"</span><span class="p">)</span>

    <span class="n">after_installcmd</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">batchcmds</span><span class="p">)</span>
        <span class="n">batchcmds</span><span class="p">:</span><span class="n">mkdir</span><span class="p">(</span><span class="n">package</span><span class="p">:</span><span class="n">installdir</span><span class="p">(</span><span class="s2">"resources"</span><span class="p">))</span>
        <span class="n">batchcmds</span><span class="p">:</span><span class="n">cp</span><span class="p">(</span><span class="s2">"src/assets/*.txt"</span><span class="p">,</span> <span class="n">package</span><span class="p">:</span><span class="n">installdir</span><span class="p">(</span><span class="s2">"resources"</span><span class="p">),</span> <span class="p">{</span><span class="n">rootdir</span> <span class="o">=</span> <span class="s2">"src"</span><span class="p">})</span>
        <span class="n">batchcmds</span><span class="p">:</span><span class="n">mkdir</span><span class="p">(</span><span class="n">package</span><span class="p">:</span><span class="n">installdir</span><span class="p">(</span><span class="s2">"stub"</span><span class="p">))</span>
    <span class="k">end</span><span class="p">)</span>

    <span class="n">after_uninstallcmd</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">batchcmds</span><span class="p">)</span>
        <span class="n">batchcmds</span><span class="p">:</span><span class="n">rmdir</span><span class="p">(</span><span class="n">package</span><span class="p">:</span><span class="n">installdir</span><span class="p">(</span><span class="s2">"resources"</span><span class="p">))</span>
        <span class="n">batchcmds</span><span class="p">:</span><span class="n">rmdir</span><span class="p">(</span><span class="n">package</span><span class="p">:</span><span class="n">installdir</span><span class="p">(</span><span class="s2">"stub"</span><span class="p">))</span>
    <span class="k">end</span><span class="p">)</span>
</code></pre>
</div>

<p>我们通过 <code class="highlighter-rouge">includes("@builtin/xpack")</code> 引入 xpack 的所有配置接口，包括 xpack 配置域，以及它的所有域接口。</p>

<p>然后我们执行：</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake pack
</code></pre>
</div>

<p>即可生成所有安装包。</p>

<h3 id="生成-nsis-安装包">生成 NSIS 安装包</h3>

<p>只要配置了 <code class="highlighter-rouge">set_formats("nsis")</code> 格式，然后执行 <code class="highlighter-rouge">xmake pack</code> 命令，就能生成 NSIS 格式的安装包。</p>

<p>另外，xmake 还会自动安装生成 NSIS 包所需的工具，实现真正的一键打包。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake pack
note: install or modify <span class="o">(</span>m<span class="o">)</span> these packages <span class="o">(</span>pass -y to skip confirm<span class="o">)</span>?
<span class="k">in </span>xmake-repo:
  -&gt; nsis 3.09
please input: y <span class="o">(</span>y/n/m<span class="o">)</span>

  <span class="o">=</span>&gt; install nsis 3.09 .. ok

<span class="o">[</span> 25%]: compiling.release src<span class="se">\m</span>ain.cpp
<span class="o">[</span> 37%]: compiling.release src<span class="se">\m</span>ain.cpp
<span class="o">[</span> 50%]: linking.release foo.dll
<span class="o">[</span> 62%]: linking.release test.exe
packing build<span class="se">\x</span>pack<span class="se">\t</span>est<span class="se">\t</span>est-windows-x64-v1.0.0.exe
pack ok
</code></pre>
</div>

<p><code class="highlighter-rouge">test-windows-x64-v1.0.0.exe</code> 就是我们生成的安装包，双击运行它，就能安装我们的二进制文件到指定目录。</p>

<p><img src="https://xmake.io/assets/img/manual/nsis_1.png" alt="" />
<img src="https://xmake.io/assets/img/manual/nsis_2.png" alt="" />
<img src="https://xmake.io/assets/img/manual/nsis_3.png" alt="" /></p>

<h4 id="增加组件安装">增加组件安装</h4>

<p>我们还可以给 NSIS 增加组件安装命令，只有当用户选择指定组件的时候，它的安装命令才会被执行。</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">xpack</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
    <span class="n">add_components</span><span class="p">(</span><span class="s2">"LongPath"</span><span class="p">)</span>

<span class="n">xpack_component</span><span class="p">(</span><span class="s2">"LongPath"</span><span class="p">)</span>
    <span class="n">set_default</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
    <span class="n">set_title</span><span class="p">(</span><span class="s2">"Enable Long Path"</span><span class="p">)</span>
    <span class="n">set_description</span><span class="p">(</span><span class="s2">"Increases the maximum path length limit, up to 32,767 characters (before 256)."</span><span class="p">)</span>
    <span class="n">on_installcmd</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">batchcmds</span><span class="p">)</span>
        <span class="n">batchcmds</span><span class="p">:</span><span class="n">rawcmd</span><span class="p">(</span><span class="s2">"nsis"</span><span class="p">,</span> <span class="s">[[
  ${If} $NoAdmin == "false"
    ; Enable long path
    WriteRegDWORD ${HKLM} "SYSTEM\CurrentControlSet\Control\FileSystem" "LongPathsEnabled" 1
  ${EndIf}]]</span><span class="p">)</span>
    <span class="k">end</span><span class="p">)</span>
</code></pre>
</div>

<p>这个例子中，我们在里面添加了一个 NSIS 特有的自定义命令，去实现对长路径的支持。</p>

<p><img src="https://xmake.io/assets/img/manual/nsis_4.png" alt="" /></p>

<h3 id="生成自安装包">生成自安装包</h3>

<p>我们也可以生成基于 shell 脚本的自编译安装包。我们需要配置 runself 打包格式，然后通过 <code class="highlighter-rouge">add_sourcefiles</code> 添加需要参与编译安装的源文件。</p>

<p>接着，我们需要自定义 on_installcmd 安装脚本，里面去配置如果编译源码包，我们可以简单的调用一个内置的编译安装脚本文件，也可以直接配置 <code class="highlighter-rouge">make install</code> 等编译安装命令。</p>

<p>例如：</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">xpack</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
    <span class="n">set_formats</span><span class="p">(</span><span class="s2">"runself"</span><span class="p">)</span>
    <span class="n">add_sourcefiles</span><span class="p">(</span><span class="s2">"(src/**)"</span><span class="p">)</span>
    <span class="n">on_installcmd</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">batchcmds</span><span class="p">)</span>
        <span class="n">batchcmds</span><span class="p">:</span><span class="n">runv</span><span class="p">(</span><span class="s2">"make"</span><span class="p">,</span> <span class="p">{</span><span class="s2">"install"</span><span class="p">})</span>
    <span class="k">end</span><span class="p">)</span>
</code></pre>
</div>

<p>然后，我们执行 <code class="highlighter-rouge">xmake pack</code> 命令，就可以生成一个自安装的 xxx.gz.run 包，默认采用 gzip 压缩。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake pack
packing build/xpack/test/test-macosx-src-v1.0.0.gz.run
pack ok
</code></pre>
</div>

<p>我们可以使用 sh 去加载运行它来安装我们的程序。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>sh ./build/xpack/test/test-macosx-src-v1.0.0.gz.run
</code></pre>
</div>

<p>我们也可以看一个比较完整的例子：</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">xpack</span><span class="p">(</span><span class="s2">"xmakesrc"</span><span class="p">)</span>
    <span class="n">set_formats</span><span class="p">(</span><span class="s2">"runself"</span><span class="p">)</span>
    <span class="n">set_basename</span><span class="p">(</span><span class="s2">"xmake-v$(version)"</span><span class="p">)</span>
    <span class="n">set_prefixdir</span><span class="p">(</span><span class="s2">"xmake-$(version)"</span><span class="p">)</span>
    <span class="n">before_package</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">package</span><span class="p">)</span>
        <span class="n">import</span><span class="p">(</span><span class="s2">"devel.git"</span><span class="p">)</span>

        <span class="kd">local</span> <span class="n">rootdir</span> <span class="o">=</span> <span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">tmpfile</span><span class="p">(</span><span class="n">package</span><span class="p">:</span><span class="n">basename</span><span class="p">())</span> <span class="o">..</span> <span class="s2">".dir"</span><span class="p">,</span> <span class="s2">"repo"</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">rootdir</span><span class="p">)</span> <span class="k">then</span>
            <span class="n">os</span><span class="p">.</span><span class="n">tryrm</span><span class="p">(</span><span class="n">rootdir</span><span class="p">)</span>
            <span class="n">os</span><span class="p">.</span><span class="n">cp</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">directory</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">projectdir</span><span class="p">()),</span> <span class="n">rootdir</span><span class="p">)</span>

            <span class="n">git</span><span class="p">.</span><span class="n">clean</span><span class="p">({</span><span class="n">repodir</span> <span class="o">=</span> <span class="n">rootdir</span><span class="p">,</span> <span class="n">force</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span> <span class="n">all</span> <span class="o">=</span> <span class="kc">true</span><span class="p">})</span>
            <span class="n">git</span><span class="p">.</span><span class="n">reset</span><span class="p">({</span><span class="n">repodir</span> <span class="o">=</span> <span class="n">rootdir</span><span class="p">,</span> <span class="n">hard</span> <span class="o">=</span> <span class="kc">true</span><span class="p">})</span>
            <span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">rootdir</span><span class="p">,</span> <span class="s2">".gitmodules"</span><span class="p">))</span> <span class="k">then</span>
                <span class="n">git</span><span class="p">.</span><span class="n">submodule</span><span class="p">.</span><span class="n">clean</span><span class="p">({</span><span class="n">repodir</span> <span class="o">=</span> <span class="n">rootdir</span><span class="p">,</span> <span class="n">force</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span> <span class="n">all</span> <span class="o">=</span> <span class="kc">true</span><span class="p">})</span>
                <span class="n">git</span><span class="p">.</span><span class="n">submodule</span><span class="p">.</span><span class="n">reset</span><span class="p">({</span><span class="n">repodir</span> <span class="o">=</span> <span class="n">rootdir</span><span class="p">,</span> <span class="n">hard</span> <span class="o">=</span> <span class="kc">true</span><span class="p">})</span>
            <span class="k">end</span>
        <span class="k">end</span>

        <span class="kd">local</span> <span class="n">extraconf</span> <span class="o">=</span> <span class="p">{</span><span class="n">rootdir</span> <span class="o">=</span> <span class="n">rootdir</span><span class="p">}</span>
        <span class="n">package</span><span class="p">:</span><span class="n">add</span><span class="p">(</span><span class="s2">"sourcefiles"</span><span class="p">,</span> <span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">rootdir</span><span class="p">,</span> <span class="s2">"core/**|src/pdcurses/**|src/luajit/**|src/tbox/tbox/src/demo/**"</span><span class="p">),</span> <span class="n">extraconf</span><span class="p">)</span>
        <span class="n">package</span><span class="p">:</span><span class="n">add</span><span class="p">(</span><span class="s2">"sourcefiles"</span><span class="p">,</span> <span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">rootdir</span><span class="p">,</span> <span class="s2">"xmake/**"</span><span class="p">),</span> <span class="n">extraconf</span><span class="p">)</span>
        <span class="n">package</span><span class="p">:</span><span class="n">add</span><span class="p">(</span><span class="s2">"sourcefiles"</span><span class="p">,</span> <span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">rootdir</span><span class="p">,</span> <span class="s2">"*.md"</span><span class="p">),</span> <span class="n">extraconf</span><span class="p">)</span>
        <span class="n">package</span><span class="p">:</span><span class="n">add</span><span class="p">(</span><span class="s2">"sourcefiles"</span><span class="p">,</span> <span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">rootdir</span><span class="p">,</span> <span class="s2">"configure"</span><span class="p">),</span> <span class="n">extraconf</span><span class="p">)</span>
        <span class="n">package</span><span class="p">:</span><span class="n">add</span><span class="p">(</span><span class="s2">"sourcefiles"</span><span class="p">,</span> <span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">rootdir</span><span class="p">,</span> <span class="s2">"scripts/*.sh"</span><span class="p">),</span> <span class="n">extraconf</span><span class="p">)</span>
        <span class="n">package</span><span class="p">:</span><span class="n">add</span><span class="p">(</span><span class="s2">"sourcefiles"</span><span class="p">,</span> <span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">rootdir</span><span class="p">,</span> <span class="s2">"scripts/man/**"</span><span class="p">),</span> <span class="n">extraconf</span><span class="p">)</span>
        <span class="n">package</span><span class="p">:</span><span class="n">add</span><span class="p">(</span><span class="s2">"sourcefiles"</span><span class="p">,</span> <span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">rootdir</span><span class="p">,</span> <span class="s2">"scripts/debian/**"</span><span class="p">),</span> <span class="n">extraconf</span><span class="p">)</span>
        <span class="n">package</span><span class="p">:</span><span class="n">add</span><span class="p">(</span><span class="s2">"sourcefiles"</span><span class="p">,</span> <span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">rootdir</span><span class="p">,</span> <span class="s2">"scripts/msys/**"</span><span class="p">),</span> <span class="n">extraconf</span><span class="p">)</span>
    <span class="k">end</span><span class="p">)</span>

    <span class="n">on_installcmd</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">batchcmds</span><span class="p">)</span>
        <span class="n">batchcmds</span><span class="p">:</span><span class="n">runv</span><span class="p">(</span><span class="s2">"./scripts/get.sh"</span><span class="p">,</span> <span class="p">{</span><span class="s2">"__local__"</span><span class="p">})</span>
    <span class="k">end</span><span class="p">)</span>
</code></pre>
</div>

<p>它是 xmake 自身源码的安装包配置脚本，更完整的配置可以参考：<a href="https://github.com/xmake-io/xmake/blob/master/core/xpack.lua">xpack.lua</a></p>

<p>这里，它通过调用源码包内置的 <code class="highlighter-rouge">./scripts/get.sh</code> 安装脚本去执行编译安装。</p>

<h3 id="生成源码归档包">生成源码归档包</h3>

<p>另外，我们也可以配置 <code class="highlighter-rouge">srczip</code> 和 <code class="highlighter-rouge">srctargz</code> 格式，来生成源码压缩包，它不是完整的安装包，也没有安装命令，仅仅用于源码包分发。</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">xpack</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
    <span class="n">set_formats</span><span class="p">(</span><span class="s2">"srczip"</span><span class="p">,</span> <span class="s2">"srctargz"</span><span class="p">)</span>
    <span class="n">add_sourcefiles</span><span class="p">(</span><span class="s2">"(src/**)"</span><span class="p">)</span>
</code></pre>
</div>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake pack
packing build/xpack/test/test-macosx-src-v1.0.0.zip ..
packing build/xpack/test/test-macosx-src-v1.0.0.tar.gz ..
pack ok
</code></pre>
</div>

<h3 id="生成二进制归档包">生成二进制归档包</h3>

<p>我们也可以配置 <code class="highlighter-rouge">zip</code> 和 <code class="highlighter-rouge">targz</code> 来生成二进制的压缩包，它会先自动编译所有绑定的 target 目标程序，将所有需要的二进制程序，库文件打包到 zip/tar.gz 格式。</p>

<p>这通常用于制作绿色版的安装包，内部不太任何自动安装脚本，用户需要自己设置 PATH 等环境变量。</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">xpack</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
    <span class="n">set_formats</span><span class="p">(</span><span class="s2">"zip"</span><span class="p">,</span> <span class="s2">"targz"</span><span class="p">)</span>
    <span class="n">add_installfiles</span><span class="p">(</span><span class="s2">"(src/**)"</span><span class="p">)</span>
</code></pre>
</div>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake pack
packing build/xpack/test/test-macosx-v1.0.0.zip ..
packing build/xpack/test/test-macosx-v1.0.0.tar.gz ..
pack ok
</code></pre>
</div>

<p>!&gt; 需要注意的是，打二进制文件到包里，使用的是 <code class="highlighter-rouge">add_installfiles</code> 而不是 <code class="highlighter-rouge">add_sourcefiles</code>。</p>

<p>我们也可以通过 <code class="highlighter-rouge">add_targets</code> 去绑定需要安装的 target 目标程序和库。更多详情见下面关于 <code class="highlighter-rouge">add_targets</code> 的接口描述。</p>

<h3 id="生成-srpm-源码安装包">生成 SRPM 源码安装包</h3>

<p>它可以生成 <code class="highlighter-rouge">.src.rpm</code> 格式的源码安装包。</p>

<p>我们可以通过配置 add_targets 关联需要构建的目标，在生成的 srpm 包中，它会自动调用 <code class="highlighter-rouge">xmake build</code> 和 <code class="highlighter-rouge">xmake install</code> 去构建和安装包。</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">xpack</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
    <span class="n">set_homepage</span><span class="p">(</span><span class="s2">"https://xmake.io"</span><span class="p">)</span>
    <span class="n">set_license</span><span class="p">(</span><span class="s2">"Apache-2.0"</span><span class="p">)</span>
    <span class="n">set_description</span><span class="p">(</span><span class="s2">"A cross-platform build utility based on Lua."</span><span class="p">)</span>

    <span class="n">set_formats</span><span class="p">(</span><span class="s2">"srpm"</span><span class="p">)</span>
    <span class="n">add_sourcefiles</span><span class="p">(</span><span class="s2">"(src/**)"</span><span class="p">)</span>
    <span class="n">add_sourcefiles</span><span class="p">(</span><span class="s2">"./xmake.lua"</span><span class="p">)</span>

    <span class="n">add_targets</span><span class="p">(</span><span class="s2">"demo"</span><span class="p">)</span>
</code></pre>
</div>

<p>它会生成类似下面的 spec 文件，然后自动调用 rpmbuild 去生成 <code class="highlighter-rouge">.src.rpm</code> 包。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Name:       test
Version:    1.0.0
Release:    1%{?dist}
Summary:    hello

License:    Apache-2.0
URL:        https://xmake.io
Source0:    test-linux-src-v1.0.0.tar.gz

BuildRequires: xmake
BuildRequires: gcc
BuildRequires: gcc-c++

%description
A test installer.

%prep
%autosetup -n test-1.0.0 -p1

%build
xmake build -y test

%install
xmake install -o %{buildroot}/%{_exec_prefix} test
cd %{buildroot}
find . -type f | sed 's!^\./!/!' &gt; %{_builddir}/_installedfiles.txt

%check

%files -f %{_builddir}/_installedfiles.txt

%changelog
* Fri Dec 22 2023 ruki - 1.0.0-1
- Update to 1.0.0
</code></pre>
</div>

<p>我们也可以通过 <code class="highlighter-rouge">on_buildcmd</code> 和 <code class="highlighter-rouge">on_installcmd</code> 自定义构建和安装脚本。</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">xpack</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
    <span class="n">set_homepage</span><span class="p">(</span><span class="s2">"https://xmake.io"</span><span class="p">)</span>
    <span class="n">set_license</span><span class="p">(</span><span class="s2">"Apache-2.0"</span><span class="p">)</span>
    <span class="n">set_description</span><span class="p">(</span><span class="s2">"A cross-platform build utility based on Lua."</span><span class="p">)</span>

    <span class="n">set_formats</span><span class="p">(</span><span class="s2">"srpm"</span><span class="p">)</span>
    <span class="n">add_sourcefiles</span><span class="p">(</span><span class="s2">"(src/**)"</span><span class="p">)</span>
    <span class="n">add_sourcefiles</span><span class="p">(</span><span class="s2">"./configure"</span><span class="p">)</span>

    <span class="n">on_buildcmd</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">batchcmds</span><span class="p">)</span>
        <span class="n">batchcmds</span><span class="p">:</span><span class="n">runv</span><span class="p">(</span><span class="s2">"./configure"</span><span class="p">)</span>
        <span class="n">batchcmds</span><span class="p">:</span><span class="n">runv</span><span class="p">(</span><span class="s2">"make"</span><span class="p">)</span>
    <span class="k">end</span><span class="p">)</span>

    <span class="n">on_installcmd</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">batchcmds</span><span class="p">)</span>
        <span class="n">batchcmds</span><span class="p">:</span><span class="n">runv</span><span class="p">(</span><span class="s2">"make"</span><span class="p">,</span> <span class="p">{</span><span class="s2">"install"</span><span class="p">,</span> <span class="s2">"PREFIX=%{buildroot}"</span><span class="p">})</span>
    <span class="k">end</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="生成-rpm-二进制安装包">生成 RPM 二进制安装包</h3>

<p>RPM 包将会直接生成编译好的二进制安装包。xmake 会自动调用 <code class="highlighter-rouge">rpmbuild --rebuild</code> 命令去构建 SRPM 包生成它。</p>

<p>而在 XPack 中，我们仅仅只需要配置 <code class="highlighter-rouge">set_formats("rpm")</code> 即可支持 rpm 包生成，其他配置与 srpm 包完全一致。</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">xpack</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
    <span class="n">set_formats</span><span class="p">(</span><span class="s2">"rpm"</span><span class="p">)</span>
    <span class="c1">-- TODO</span>
</code></pre>
</div>

<h3 id="打包命令参数">打包命令参数</h3>

<h4 id="指定打包格式">指定打包格式</h4>

<p>如果我们在配置文件中已经使用 <code class="highlighter-rouge">set_formats</code> 配置了多个打包格式，那么默认情况下，<code class="highlighter-rouge">xmake pack</code> 会自动生成所有这些格式的包。</p>

<p>当然，我们也可以通过 <code class="highlighter-rouge">xmake pack --formats=nsis,targz</code> 来选择性指定当前需要打哪些格式的包。</p>

<h4 id="修改打包文件名">修改打包文件名</h4>

<p>我们可以在配置文件中，通过 <code class="highlighter-rouge">set_basename()</code> 来修改包名，也可以通过命令行去修改它。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake pack --basename<span class="o">=</span><span class="s2">"foo"</span>
packing build/xpack/test/foo.zip ..
pack ok
</code></pre>
</div>

<h4 id="指定输出目录">指定输出目录</h4>

<p>默认的输出目录是在 build 目录下，但我们也可以修改输出的路径。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake pack -o /tmp/output
</code></pre>
</div>

<h4 id="禁用自动构建">禁用自动构建</h4>

<p>如果是打 NSIS 等二进制包，<code class="highlighter-rouge">xmake pack</code> 会先自动编译所有被绑定的 target 目标文件，然后再去执行打包逻辑。</p>

<p>但是如果我们已经编译过了，不想每次都去编译它，而是直接去打包，可以通过下面的参数禁用自动构建。</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>xmake pack --autobuild<span class="o">=</span>n
</code></pre>
</div>

<h3 id="接口描述">接口描述</h3>

<p>更多 XPack 打包接口描述见：<a href="https://xmake.io/#/zh-cn/manual/xpack">XPack 打包接口文档</a>。</p>

<h3 id="安装包到本地">安装包到本地</h3>

<p>默认情况先，通过 <code class="highlighter-rouge">add_requires("xxx")</code> 配置的包都会被安装到全局目录，不同项目共用这些包。</p>

<p>而新版本中，我们新增了一个 <code class="highlighter-rouge">package.install_locally</code> 策略，可以配置让 xmake 将包安装到当前本地项目目录。</p>

<div class="language-lua highlighter-rouge"><pre class="highlight"><code><span class="n">set_policy</span><span class="p">(</span><span class="s2">"package.install_locally"</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="更新日志">更新日志</h2>

<h3 id="新特性">新特性</h3>

<ul>
  <li>添加 <code class="highlighter-rouge">network.mode</code> 策略</li>
  <li><a href="https://github.com/xmake-io/xmake/issues/1433">#1433</a>: 添加 <code class="highlighter-rouge">xmake pack</code> 命令去生成 NSIS/zip/tar.gz/srpm/rpm/runself 安装包</li>
  <li><a href="https://github.com/xmake-io/xmake/issues/4435">#4435</a>: 为 UnityBuild 的组模式增加 batchsize 支持</li>
  <li><a href="https://github.com/xmake-io/xmake/pull/4485">#4485</a>: 新增 package.install_locally 策略支持</li>
  <li>新增 NetBSD 支持</li>
</ul>

<h3 id="changes">Changes</h3>

<ul>
  <li><a href="https://github.com/xmake-io/xmake/pull/4484">#4484</a>: 改进 swig 规则</li>
  <li>改进 Haiku 支持</li>
</ul>

<h3 id="bugs-修复">Bugs 修复</h3>

<ul>
  <li><a href="https://github.com/xmake-io/xmake/issues/4372">#4372</a>: 修复 protobuf 规则</li>
  <li><a href="https://github.com/xmake-io/xmake/issues/4439">#4439</a>: 修复 asn1c 规则</li>
</ul>


        </article>
        <hr>

        <!-- wwads -->
        
        <div class="wwads-cn wwads-horizontal" data-id="243" style="max-width:100%"></div>
        

        <!-- baidu ads -->
        

        <!-- reward -->
        <div style="text-align: center;">
            <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
              <span>赏</span>
            </button>
            <div id="QR" style="display: none;">
                <div id="wechat" style="display: inline-block">
                  <img id="wechat_qr" src="/static/img/weixin.png" alt="WeChat Pay"/>
                  <p>微信打赏</p>
                </div>
                <div id="alipay" style="display: inline-block">
                  <img id="alipay_qr" src="/static/img/alipay.png" alt="Alipay"/>
                  <p>支付宝打赏</p>
                </div>
            </div>
        </div>

        
        
            
            
                
                    
                    <h2 id="english">English</h2>
                    <ul>
                    
                    <li class="relatedPost">
                        <a href="/2023/12/15/xmake-update-v2.8.6/">Xmake v2.8.6 released, New Packaging Plugin: XPack
                        
                        </a>
                    </li>
                    
                    
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
            
            
                
            
        
            
        
        
            </ul>
        

        
        
            
        
            
        
            
            
            
                
                    
                        
                        <h2 id="similar_posts">相关文章</h2>
                        <ul>
                        
                        <li class="relatedPost">
                            <a href="/cn/2023/11/05/xmake-update-v2.8.5/">Xmake v2.8.5 发布，支持链接排序和单元测试
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
            
        
            
        
            
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/cn/2023/09/26/xmake-update-v2.8.3/">Xmake v2.8.3 发布，改进 Wasm 并支持 Xmake 源码调试
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
            
        
            
        
            
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/cn/2023/08/22/xmake-update-v2.8.2/">Xmake v2.8.2 发布，官方包仓库数量突破 1k
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
            
        
            
        
            
            
            
                
                    
                        
                        <li class="relatedPost">
                            <a href="/cn/2023/07/11/xmake-update-v2.8.1/">Xmake v2.8.1 发布，大量细节特性改进
                            
                            </a>
                        </li>
                        
                        
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
            
        
            
        
        
            </ul>
        

        <div class="post-recent">
    <div class="pre">

        

        

        
        
        

        

        

        
        
        <p><strong>上一篇</strong> <a href="/cn/2023/11/05/xmake-update-v2.8.5/">Xmake v2.8.5 发布，支持链接排序和单元测试</a></p>
        
    </div>

    <div class="nex">

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        

        

        
        
        

        

        

        

        
    </div>
</div>


        <h2 id="comments">评论</h2>
        









    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    内容
                </div>
                <ul id="content-side" class="content-ul">
                    <li><a href="#english">English</a></li>
                    <li><a href="#similar_posts">相关文章</a></li>
                    <li><a href="#comments">评论</a></li>
                </ul>
            </div>

            <!-- wwads -->
            
            <div class="side">
            <div class="wwads-cn wwads-vertical" data-id="243" style="max-width:255px;height:250px"></div>
            </div>
            

            <!-- baidu ads -->
            

            <br>
            <div class="side">
                <div>
                    <i class="fa fa-external-link"></i>
                    链接
                </div>
                <ul class="content-ul">
                  <li><a href="http://github.com/waruqi/tbox">tbox</a></li>
                  <li><a href="http://www.xmake.io">xmake</a></li>
                  <li><a href="https://github.com/waruqi">github</a></li>
                </ul>
            </div>

            <!-- xmake courses -->
            <br>
            <div class="side">
                <div>
                    <i class="fa fa-external-link"></i>
                    xmake 入门课程
                </div>
                <a href="https://xmake.io/#/zh-cn/about/course" target="_blank">
                <img src="/static/img/xmake-course.png" alt="course" width="256" height="193">
                </a>
            </div>

            <!-- qqgroup -->
            <br>
            <div class="side">
                <div>
                    <i class="fa fa-external-link"></i>
                    技术交流群（QQ）
                </div>
                <img src="/static/img/qqgroup.png" alt="qqgroup" width="256" height="284">
            </div>

            <!-- google ads -->
            

            <!-- baidu ads -->
            

        </div>
    </div>

    <!-- baidu ads -->
    
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<script src="/js/pageContent.js " charset="utf-8"></script>



    <footer class="site-footer">
    <div class="wrapper">
        <p class="description">
             Copyright (c) 2016-latest tboox.org 
        </p>
        <p class="contact">
            
            <a href="https://github.com/waruqi" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a> 
             
            
            <a href="mailto:waruqi@gmail.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a> 
            
            
            <a href="https://twitter.com/waruqi" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a> 
            
            <a href="/feed.xml" title="feed"><i class="fa fa-feed" aria-hidden="true"></i></a> 
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://github.com/Gaohaoyang">HyG</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
        </p>
    </div>
</footer>

    <div class="back-to-top">
    <a href="#top" class="scroll">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/scroll.min.js " charset="utf-8"></script>
  </body>

</html>
